/*! Filter widget formatter functions - updated 2/19/2014 (v2.15.0)
 * requires: tableSorter 2.7.7+ and jQuery 1.4.3+
 * jQuery UI spinner, silder, range slider & datepicker (range)
 * HTML5 number (spinner), range slider & color selector
 */
;(function(h){var s=h.tablesorter||{},p=s.filterFormatter={addCompare:function(b,c,f){if(f.compare&&h.isArray(f.compare)&&1<f.compare.length){var a="",e=[".compare-select".slice(1)," "+".compare-select".slice(1),""],g=f.cellText?'<label class="'+e.join("-label")+c+'">'+f.cellText+"</label>":"";h.each(f.compare,function(b,d){a+="<option "+(f.selected===b?"selected":"")+">"+d+"</option>"});b.wrapInner('<div class="'+e.join("-wrapper")+c+'" />').prepend(g+'<select class="'+e.join("")+c+'" />').find("select").append(a)}}, updateCompare:function(b,c,f){c=c.val()||"";var a=c.replace(/\s*?[><=]\s*?/g,""),e=c.match(/[><=]/g)||"";f.compare&&(h.isArray(f.compare)&&(e=(e||[]).join("")||f.compare[f.selected||0]),b.find(".compare-select").val(e));return[c,a]},uiSpinner:function(b,c,f){var a=h.extend({delayed:!0,addToggle:!0,exactMatch:!0,value:1,cellText:"",compare:"",min:0,max:100,step:1,disabled:!1},f),e=h('<input class="filter" type="hidden">').appendTo(b).bind("change.tsfilter",function(){d({value:this.value,delayed:!1})}), g=[],k=b.closest("table")[0].config,d=function(d,e){var q=!0,c,r=d&&d.value&&s.formatFloat((d.value+"").replace(/[><=]/g,""))||b.find(".spinner").val()||a.value,t=(h.isArray(a.compare)?b.find(".compare-select").val()||a.compare[a.selected||0]:a.compare)||"",f=d&&"boolean"===typeof d.delayed?d.delayed:k.$table[0].hasInitialized?a.delayed:!0;a.addToggle&&(q=b.find(".toggle").is(":checked"));c=a.disabled||!q?"disable":"enable";b.find(".filter").val(q?(t?t:a.exactMatch?"=":"")+r:"").trigger(e?"":"search", f).end().find(".spinner").spinner(c).val(r);g.length&&(g.find(".spinner").spinner(c).val(r).end().find(".compare-select").val(t),a.addToggle&&(g.find(".toggle")[0].checked=q))};a.oldcreate=a.create;a.oldspin=a.spin;a.create=function(b,e){d();"function"===typeof a.oldcreate&&a.oldcreate(b,e)};a.spin=function(b,e){d(e);"function"===typeof a.oldspin&&a.oldspin(b,e)};a.addToggle&&h('<div class="button"><input id="uispinnerbutton'+c+'" type="checkbox" class="toggle" /><label for="uispinnerbutton'+c+'"></label></div>').appendTo(b).find(".toggle").bind("change", function(){d()});b.closest("thead").find("th[data-column="+c+"]").addClass("filter-parsed");h('<input class="spinner spinner'+c+'" />').val(a.value).appendTo(b).spinner(a).bind("change keyup",function(){d()});k.$table.bind("filterFomatterUpdate",function(){var c=p.updateCompare(b,e,a)[0];b.find(".spinner").val(c);d({value:c},!0)});a.compare&&(p.addCompare(b,c,a),b.find(".compare-select").bind("change",function(){d()}));k.$table.bind("stickyHeadersInit",function(){g=k.widgetOptions.$sticky.find(".tablesorter-filter-row").children().eq(c).empty(); a.addToggle&&h('<div class="button"><input id="stickyuispinnerbutton'+c+'" type="checkbox" class="toggle" /><label for="stickyuispinnerbutton'+c+'"></label></div>').appendTo(g).find(".toggle").bind("change",function(){b.find(".toggle")[0].checked=this.checked;d()});h('<input class="spinner spinner'+c+'" />').val(a.value).appendTo(g).spinner(a).bind("change keyup",function(){b.find(".spinner").val(this.value);d()});a.compare&&(p.addCompare(g,c,a),g.find(".compare-select").bind("change",function(){b.find(".compare-select").val(h(this).val()); d()}))});k.$table.bind("filterReset",function(){h.isArray(a.compare)&&b.add(g).find(".compare-select").val(a.compare[a.selected||0]);a.addToggle&&(b.find(".toggle")[0].checked=!1);b.find(".spinner").spinner("value",a.value);setTimeout(function(){d()},0)});d();return e},uiSlider:function(b,c,f){var a=h.extend({delayed:!0,valueToHeader:!1,exactMatch:!0,cellText:"",compare:"",allText:"all",value:0,min:0,max:100,step:1,range:"min"},f),e=h('<input class="filter" type="hidden">').appendTo(b).bind("change.tsfilter", function(){d({value:this.value})}),g=[],k=b.closest("table")[0].config,d=function(d,e){var q="undefined"!==typeof d?s.formatFloat((d.value+"").replace(/[><=]/g,""))||a.value:a.value,n=a.compare?q:q===a.min?a.allText:q,r=(h.isArray(a.compare)?b.find(".compare-select").val()||a.compare[a.selected||0]:a.compare)||"",n=r+n,f=d&&"boolean"===typeof d.delayed?d.delayed:k.$table[0].hasInitialized?a.delayed:!0;a.valueToHeader?b.closest("thead").find("th[data-column="+c+"]").find(".curvalue").html(" ("+n+")"): b.find(".ui-slider-handle").addClass("value-popup").attr("data-value",n);b.find(".filter").val(r?r+q:q===a.min?"":(a.exactMatch?"=":"")+q).trigger(e?"":"search",f).end().find(".slider").slider("value",q);g.length&&(g.find(".compare-select").val(r).end().find(".slider").slider("value",q),a.valueToHeader?g.closest("thead").find("th[data-column="+c+"]").find(".curvalue").html(" ("+n+")"):g.find(".ui-slider-handle").addClass("value-popup").attr("data-value",n))};b.closest("thead").find("th[data-column="+ c+"]").addClass("filter-parsed");a.valueToHeader&&b.closest("thead").find("th[data-column="+c+"]").find(".tablesorter-header-inner").append('<span class="curvalue" />');a.oldcreate=a.create;a.oldslide=a.slide;a.create=function(b,e){d();"function"===typeof a.oldcreate&&a.oldcreate(b,e)};a.slide=function(b,e){d(e);"function"===typeof a.oldslide&&a.oldslide(b,e)};h('<div class="slider slider'+c+'"/>').appendTo(b).slider(a);k.$table.bind("filterFomatterUpdate",function(){var c=p.updateCompare(b,e,a)[0]; b.find(".slider").slider("value",c);d({value:c},!1)});a.compare&&(p.addCompare(b,c,a),b.find(".compare-select").bind("change",function(){d({value:b.find(".slider").slider("value")})}));k.$table.bind("filterReset",function(){h.isArray(a.compare)&&b.add(g).find(".compare-select").val(a.compare[a.selected||0]);setTimeout(function(){d({value:a.value})},0)});k.$table.bind("stickyHeadersInit",function(){g=k.widgetOptions.$sticky.find(".tablesorter-filter-row").children().eq(c).empty();h('<div class="slider slider'+ c+'"/>').val(a.value).appendTo(g).slider(a).bind("change keyup",function(){b.find(".slider").slider("value",this.value);d()});a.compare&&(p.addCompare(g,c,a),g.find(".compare-select").bind("change",function(){b.find(".compare-select").val(h(this).val());d()}))});return e},uiRange:function(b,c,f){var a=h.extend({delayed:!0,valueToHeader:!1,values:[0,100],min:0,max:100,range:!0},f),e=h('<input class="filter" type="hidden">').appendTo(b).bind("change.tsfilter",function(){d()}),g=[],k=b.closest("table")[0].config, d=function(){var b=e.val(),d=b.split(" - ");""===b&&(d=[a.min,a.max]);d&&d[1]&&l({values:d,delay:!1},!0)},l=function(d,e){var n=d&&d.values||a.values,h=n[0]+" - "+n[1],f=n[0]===a.min&&n[1]===a.max?"":h,l=d&&"boolean"===typeof d.delayed?d.delayed:k.$table[0].hasInitialized?a.delayed:!0;a.valueToHeader?b.closest("thead").find("th[data-column="+c+"]").find(".currange").html(" ("+h+")"):b.find(".ui-slider-handle").addClass("value-popup").eq(0).attr("data-value",n[0]).end().eq(1).attr("data-value",n[1]); b.find(".filter").val(f).trigger(e?"":"search",l).end().find(".range").slider("values",n);g.length&&(g.find(".range").slider("values",n),a.valueToHeader?g.closest("thead").find("th[data-column="+c+"]").find(".currange").html(" ("+h+")"):g.find(".ui-slider-handle").addClass("value-popup").eq(0).attr("data-value",n[0]).end().eq(1).attr("data-value",n[1]))};b.closest("thead").find("th[data-column="+c+"]").addClass("filter-parsed");a.valueToHeader&&b.closest("thead").find("th[data-column="+c+"]").find(".tablesorter-header-inner").append('<span class="currange"/>'); a.oldcreate=a.create;a.oldslide=a.slide;a.create=function(b,d){l();"function"===typeof a.oldcreate&&a.oldcreate(b,d)};a.slide=function(b,d){l(d);"function"===typeof a.oldslide&&a.oldslide(b,d)};h('<div class="range range'+c+'"/>').appendTo(b).slider(a);k.$table.bind("filterFomatterUpdate",function(){d()});k.$table.bind("filterReset",function(){b.find(".range").slider("values",a.values);setTimeout(function(){l()},0)});k.$table.bind("stickyHeadersInit",function(){g=k.widgetOptions.$sticky.find(".tablesorter-filter-row").children().eq(c).empty(); h('<div class="range range'+c+'"/>').val(a.value).appendTo(g).slider(a).bind("change keyup",function(){b.find(".range").val(this.value);l()})});return e},uiDateCompare:function(b,c,f){var a=h.extend({cellText:"",compare:"",endOfDay:!0,defaultDate:"",changeMonth:!0,changeYear:!0,numberOfMonths:1},f),e;f=b.closest("thead").find("th[data-column="+c+"]").addClass("filter-parsed");var g=h('<input class="dateCompare" type="hidden">').appendTo(b).bind("change.tsfilter",function(){var b=this.value;if(b)a.onClose(b)}), k,d=[],l=b.closest("table")[0].config,m=function(c,n){var f,g;f=c||e.datepicker("getDate")||"";var m=(h.isArray(a.compare)?b.find(".compare-select").val()||a.compare[a.selected||0]:a.compare)||"",k=l.$table[0].hasInitialized?a.delayed:!0;e.datepicker("setDate",""===f?a.defaultDate||"":f);""===f&&(n=!1);g=(f=e.datepicker("getDate"))?(a.endOfDay&&/<=/.test(m)?f.setHours(23,59,59):f.getTime())||"":"";f&&a.endOfDay&&"="===m&&(m="",g+=" - "+f.setHours(23,59,59),n=!1);b.find(".dateCompare").val(m+g).trigger(n? "":"search",k).end();d.length&&d.find(".dateCompare").val(m+g).end().find(".compare-select").val(m)};k='<input type="text" class="date date'+c+'" placeholder="'+(f.data("placeholder")||f.attr("data-placeholder")||"")+'" />';e=h(k).appendTo(b);a.oldonClose=a.onClose;a.onClose=function(b,d){m();"function"===typeof a.oldonClose&&a.oldonClose(b,d)};e.datepicker(a);l.$table.bind("filterReset",function(){h.isArray(a.compare)&&b.add(d).find(".compare-select").val(a.compare[a.selected||0]);b.add(d).find(".date").val(a.defaultDate).datepicker("setDate", "");setTimeout(function(){m()},0)});l.$table.bind("filterFomatterUpdate",function(){var c;c=g.val();/\s+-\s+/.test(c)?(b.find(".compare-select").val("="),c=new Date(Number(c.split(/\s+-\s+/)[0])),e.datepicker("setDate",c)):(c=p.updateCompare(b,g,a)[1].toString()||"",c=""!==c?new Date(/\d{5}/g.test(c)?Number(c):c)||"":"");b.add(d).find(".date").datepicker("setDate",c);m(c,!0)});a.compare&&(p.addCompare(b,c,a),b.find(".compare-select").bind("change",function(){m()}));l.$table.bind("stickyHeadersInit", function(){d=l.widgetOptions.$sticky.find(".tablesorter-filter-row").children().eq(c).empty();d.append(k).find(".date").datepicker(a);a.compare&&(p.addCompare(d,c,a),d.find(".compare-select").bind("change",function(){b.find(".compare-select").val(h(this).val());m()}))});return g.val(a.defaultDate?a.defaultDate:"")},uiDatepicker:function(b,c,f){var a=h.extend({endOfDay:!0,textFrom:"from",textTo:"to",from:"",to:"",changeMonth:!0,changeYear:!0,numberOfMonths:1},f),e,g,k,d=[],l=h('<input class="dateRange" type="hidden">').appendTo(b).bind("change.tsfilter", function(){var a=this.value;a.match(" - ")?(a=a.split(" - "),b.find(".dateTo").val(a[1]),k(a[0])):a.match(">=")?k(a.replace(">=","")):a.match("<=")&&g(a.replace("<=",""))}),m=b.closest("table")[0].config;b.closest("thead").find("th[data-column="+c+"]").addClass("filter-parsed");e="<label>"+a.textFrom+'</label><input type="text" class="dateFrom" /><label>'+a.textTo+'</label><input type="text" class="dateTo" />';h(e).appendTo(b);a.oldonClose=a.onClose;var q=a.defaultDate=a.from||a.defaultDate;k=a.onClose= function(c,e){var f;f=(new Date(b.find(".dateFrom").datepicker("getDate"))).getTime()||"";var g=b.find(".dateTo").datepicker("getDate")||"",g=g?(a.endOfDay?g.setHours(23,59,59):g.getTime())||"":"";f=f?g?f+" - "+g:">="+f:g?"<="+g:"";b.find(".dateRange").val(f).trigger("search").end().find(".dateTo").datepicker("option","minDate",c).end().find(".dateFrom").val(c);d.length&&d.find(".dateTo").datepicker("option","minDate",c).end().find(".dateFrom").val(c);"function"===typeof a.oldonClose&&a.oldonClose(c, e)};b.find(".dateFrom").datepicker(a);a.defaultDate=a.to||"+7d";g=a.onClose=function(c,e){var f;f=(new Date(b.find(".dateFrom").datepicker("getDate"))).getTime()||"";var g=b.find(".dateTo").datepicker("getDate")||"",g=g?(a.endOfDay?g.setHours(23,59,59):g.getTime())||"":"";f=f?g?f+" - "+g:">="+f:g?"<="+g:"";b.find(".dateRange").val(f).trigger("search").end().find(".dateFrom").datepicker("option","maxDate",c).end().find(".dateTo").val(c);d.length&&d.find(".dateFrom").datepicker("option","maxDate",c).end().find(".dateTo").val(c); "function"===typeof a.oldonClose&&a.oldonClose(c,e)};b.find(".dateTo").datepicker(a);m.$table.bind("filterFomatterUpdate",function(){var a=l.val()||"",c="",e="";/\s+-\s+/.test(a)?(a=a.split(/\s+-\s+/)||[],c=a[0]||"",e=a[1]||""):/>=/.test(a)?c=new Date(Number(a.replace(/>=/,"")))||"":/<=/.test(a)&&(e=new Date(Number(a.replace(/<=/,"")))||"");b.add(d).find(".dateFrom").datepicker("setDate",c);b.add(d).find(".dateTo").datepicker("setDate",e);g(e)});m.$table.bind("stickyHeadersInit",function(){d=m.widgetOptions.$sticky.find(".tablesorter-filter-row").children().eq(c).empty(); d.append(e);a.onClose=g;d.find(".dateTo").datepicker(a);a.defaultDate=q;a.onClose=k;d.find(".dateFrom").datepicker(a)});b.closest("table").bind("filterReset",function(){b.add(d).find(".dateFrom").val("").datepicker("setDate",a.from);b.add(d).find(".dateTo").val("").datepicker("setDate",a.to)});return l.val(a.from?a.to?a.from+" - "+a.to:">="+a.from:a.to?"<="+a.to:"")},html5Number:function(b,c,f){var a,e=h.extend({value:0,min:0,max:100,step:1,delayed:!0,disabled:!1,addToggle:!1,exactMatch:!1,cellText:"", compare:"",skipTest:!1},f),g;f=h('<input type="number" style="visibility:hidden;" value="test">').appendTo(b);var k=e.skipTest||"number"===f.attr("type")&&"test"!==f.val(),d=[],l=b.closest("table")[0].config,m=function(a,c){var f=e.addToggle?b.find(".toggle").is(":checked"):!0,m=b.find(".number").val(),k=(h.isArray(e.compare)?b.find(".compare-select").val()||e.compare[e.selected||0]:e.compare)||"",p=l.$table[0].hasInitialized?a?a:e.delayed:!0;g.val(!e.addToggle||f?(k?k:e.exactMatch?"=":"")+m:"").trigger(c? "":"search",p).end().find(".number").val(m);b.find(".number").length&&(b.find(".number")[0].disabled=e.disabled||!f);d.length&&(d.find(".number").val(m)[0].disabled=e.disabled||!f,d.find(".compare-select").val(k),e.addToggle&&(d.find(".toggle")[0].checked=f))};f.remove();k&&(a=e.addToggle?'<div class="button"><input id="html5button'+c+'" type="checkbox" class="toggle" /><label for="html5button'+c+'"></label></div>':"",a+='<input class="number" type="number" min="'+e.min+'" max="'+e.max+'" value="'+ e.value+'" step="'+e.step+'" />',b.append(a+'<input type="hidden" />').find(".toggle, .number").bind("change",function(){m()}).closest("thead").find("th[data-column="+c+"]").addClass("filter-parsed").closest("table").bind("filterReset",function(){h.isArray(e.compare)&&b.add(d).find(".compare-select").val(e.compare[e.selected||0]);e.addToggle&&(b.find(".toggle")[0].checked=!1,d.length&&(d.find(".toggle")[0].checked=!1));b.find(".number").val(e.value);setTimeout(function(){m()},0)}),g=b.find("input[type=hidden]").bind("change", function(){b.find(".number").val(this.value);m()}),l.$table.bind("filterFomatterUpdate",function(){var a=p.updateCompare(b,g,e)[0]||e.value;b.find(".number").val(((a||"")+"").replace(/[><=]/g,""));m(!1,!0)}),e.compare&&(p.addCompare(b,c,e),b.find(".compare-select").bind("change",function(){m()})),l.$table.bind("stickyHeadersInit",function(){d=l.widgetOptions.$sticky.find(".tablesorter-filter-row").children().eq(c).empty();d.append(a).find(".toggle, .number").bind("change",function(){b.find(".number").val(h(this).val()); m()});e.compare&&(p.addCompare(d,c,e),d.find(".compare-select").bind("change",function(){b.find(".compare-select").val(h(this).val());m()}));m()}),m());return k?b.find('input[type="hidden"]'):h('<input type="search">')},html5Range:function(b,c,f){var a=h.extend({value:0,min:0,max:100,step:1,delayed:!0,valueToHeader:!0,exactMatch:!0,cellText:"",compare:"",allText:"all",skipTest:!1},f),e;f=h('<input type="range" style="visibility:hidden;" value="test">').appendTo(b);var g=a.skipTest||"range"===f.attr("type")&& "test"!==f.val(),k=[],d=b.closest("table")[0].config,l=function(f,g,l){f=("undefined"===typeof f?e.val():f).toString().replace(/[<>=]/g,"")||a.value;var r=(h.isArray(a.compare)?b.find(".compare-select").val()||a.compare[a.selected||0]:a.compare)||"",p=" ("+(r?r+f:f==a.min?a.allText:f)+")";g=d.$table[0].hasInitialized?g?g:a.delayed:!0;b.find("input[type=hidden]").val(r?r+f:f==a.min?"":(a.exactMatch?"=":"")+f).trigger(l?"":"search",g).end().find(".range").val(f);b.closest("thead").find("th[data-column="+ c+"]").find(".curvalue").html(p);k.length&&(k.find(".range").val(f).end().find(".compare-select").val(r),k.closest("thead").find("th[data-column="+c+"]").find(".curvalue").html(p))};f.remove();g&&(b.html('<input type="hidden"><input class="range" type="range" min="'+a.min+'" max="'+a.max+'" value="'+a.value+'" />').closest("thead").find("th[data-column="+c+"]").addClass("filter-parsed").find(".tablesorter-header-inner").append('<span class="curvalue" />'),e=b.find("input[type=hidden]").bind("change.tsfilter", function(){var c=this.value,d=(h.isArray(a.compare)?b.find(".compare-select").val()||a.compare[a.selected||0]:a.compare)||"";c!==this.lastValue&&(this.value=this.lastValue=d?d+c:c==a.min?"":(a.exactMatch?"=":"")+c,l(c))}),b.find(".range").bind("change",function(){l(this.value)}),d.$table.bind("filterFomatterUpdate",function(){var c=p.updateCompare(b,e,a)[0];b.find(".range").val(c);l(c,!1,!0)}),a.compare&&(p.addCompare(b,c,a),b.find(".compare-select").bind("change",function(){l()})),d.$table.bind("stickyHeadersInit", function(){k=d.widgetOptions.$sticky.find(".tablesorter-filter-row").children().eq(c).empty();k.html('<input class="range" type="range" min="'+a.min+'" max="'+a.max+'" value="'+a.value+'" />').find(".range").bind("change",function(){l(k.find(".range").val())});l();a.compare&&(p.addCompare(k,c,a),k.find(".compare-select").bind("change",function(){b.find(".compare-select").val(h(this).val());l()}))}),b.closest("table").bind("filterReset",function(){h.isArray(a.compare)&&b.add(k).find(".compare-select").val(a.compare[a.selected|| 0]);setTimeout(function(){l(a.value,!1,!0)},0)}),l());return g?b.find('input[type="hidden"]'):h('<input type="search">')},html5Color:function(b,c,f){var a,e=h.extend({value:"#000000",disabled:!1,addToggle:!0,exactMatch:!0,valueToHeader:!1,skipTest:!1},f),g;f=h('<input type="color" style="visibility:hidden;" value="test">').appendTo(b);var k=e.skipTest||"color"===f.attr("type")&&"test"!==f.val(),d=[],l=b.closest("table")[0].config,m=function(a,f){a=("undefined"===typeof a?g.val():a).toString().replace("=", "")||e.value;var h=!0,k=" ("+a+")";e.addToggle&&(h=b.find(".toggle").is(":checked"));b.find(".colorpicker").length&&(b.find(".colorpicker").val(a)[0].disabled=e.disabled||!h);g.val(h?a+(e.exactMatch?"=":""):"").trigger(!l.$table[0].hasInitialized||f?"":"search");e.valueToHeader?b.closest("thead").find("th[data-column="+c+"]").find(".curcolor").html(k):b.find(".currentColor").html(k);d.length&&(d.find(".colorpicker").val(a)[0].disabled=e.disabled||!h,e.addToggle&&(d.find(".toggle")[0].checked=h),e.valueToHeader? d.closest("thead").find("th[data-column="+c+"]").find(".curcolor").html(k):d.find(".currentColor").html(k))};f.remove();k&&(a=""+c+Math.round(100*Math.random()),a='<div class="color-controls-wrapper">'+(e.addToggle?'<div class="button"><input id="colorbutton'+a+'" type="checkbox" class="toggle" /><label for="colorbutton'+a+'"></label></div>':"")+'<input type="hidden"><input class="colorpicker" type="color" />'+(e.valueToHeader?"":'<span class="currentColor">(#000000)</span>')+"</div>",b.html(a),e.valueToHeader&& b.closest("thead").find("th[data-column="+c+"]").find(".tablesorter-header-inner").append('<span class="curcolor" />'),b.find(".toggle, .colorpicker").bind("change",function(){m(b.find(".colorpicker").val())}),g=b.find("input[type=hidden]").bind("change.tsfilter",function(){m(this.value)}),l.$table.bind("filterFomatterUpdate",function(){m(g.val(),!0)}),b.closest("table").bind("filterReset",function(){e.addToggle&&(b.find(".toggle")[0].checked=!1);setTimeout(function(){m()},0)}),l.$table.bind("stickyHeadersInit", function(){d=l.widgetOptions.$sticky.find(".tablesorter-filter-row").children().eq(c);d.html(a).find(".toggle, .colorpicker").bind("change",function(){m(d.find(".colorpicker").val())});m(d.find(".colorpicker").val())}),m(e.value));return k?b.find('input[type="hidden"]'):h('<input type="search">')}}})(jQuery);
